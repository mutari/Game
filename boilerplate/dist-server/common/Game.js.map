{"version":3,"sources":["../../src/common/Game.js"],"names":["BASEX","BASEY","Player","gameEngine","options","props","other","health","Object","assign","type","BaseTypes","TYPES","INT16","DynamicObject","Thing","Game","physicsEngine","SimplePhysicsEngine","on","gameLogic","bind","serverSideInit","serverSidePlayerJoined","serverSidePlayerDisconnected","clientSideInit","clientSideDraw","serializer","registerClass","inputData","playerId","player","world","queryObject","input","position","y","x","addObjectToWorld","TwoVector","ev","queryObjects","instanceType","i","length","removeObjectFromWorld","id","controls","KeyboardControls","renderer","clientEngine","bindKey","repeat","gamePanel","document","querySelector","innerHTML","things","players","client","console","log","div","createElement","classList","add","style","width","height","top","left","border","appendChild","GameEngine"],"mappings":"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","sourcesContent":["import { GameEngine, BaseTypes, DynamicObject, SimplePhysicsEngine, TwoVector, KeyboardControls } from 'lance-gg';\n\n// /////////////////////////////////////////////////////////\n//\n// GAME OBJECTS\n//\n// /////////////////////////////////////////////////////////\nconst BASEX = 150;\nconst BASEY = 150;\nclass Player extends DynamicObject {\n\n    constructor(gameEngine, options, props) {\n        super(gameEngine, options, props);\n    }\n\n    static get netScheme() {\n        return Object.assign({\n            health: { type: BaseTypes.TYPES.INT16 }\n        }, super.netScheme);\n    }\n\n    syncTo(other) {\n        super.syncTo(other);\n        this.health = other.health;\n    }\n}\n\nclass Thing extends DynamicObject {\n\n    constructor(gameEngine, options, props) {\n        super(gameEngine, options, props);\n    }\n\n    syncTo(other) {\n        super.syncTo(other);\n    }\n\n}\n\n\n// /////////////////////////////////////////////////////////\n//\n// GAME ENGINE\n//\n// /////////////////////////////////////////////////////////\nexport default class Game extends GameEngine {\n\n    constructor(options) {\n        super(options);\n        this.physicsEngine = new SimplePhysicsEngine({ gameEngine: this });\n    \n        // common code\n        this.on('postStep', this.gameLogic.bind(this));\n    \n        // server-only code\n        this.on('server__init', this.serverSideInit.bind(this));\n        this.on('server__playerJoined', this.serverSidePlayerJoined.bind(this));\n        this.on('server__playerDisconnected', this.serverSidePlayerDisconnected.bind(this));\n    \n        // client-only code\n        this.on('client__rendererReady', this.clientSideInit.bind(this));\n        this.on('client__draw', this.clientSideDraw.bind(this));\n    }\n    \n    registerClasses(serializer) {\n        serializer.registerClass(Player);\n        serializer.registerClass(Thing);\n    }\n\n    gameLogic() {\n    }\n\n    processInput(inputData, playerId) {\n        super.processInput(inputData, playerId);\n    \n        // get the player paddle tied to the player socket\n        let player = this.world.queryObject({ playerId });\n        if (player) {\n            if (inputData.input === 'up') {\n                player.position.y -= 5;\n            } else if (inputData.input === 'down') {\n                player.position.y += 5;\n            } else if (inputData.input === 'left') {\n                player.position.x -= 5;\n            } else if (inputData.input === 'right') {\n                player.position.x += 5;\n            }\n        }\n    }\n\n\n    // /////////////////////////////////////////////////////////\n    //\n    // SERVER ONLY CODE\n    //\n    // /////////////////////////////////////////////////////////\n    serverSideInit() {\n        this.addObjectToWorld(new Thing(this, null, { position: new TwoVector(10, 100)}))\n        this.addObjectToWorld(new Thing(this, null, { position: new TwoVector(30, 100)}))\n        this.addObjectToWorld(new Thing(this, null, { position: new TwoVector(100, 10)}))\n        this.addObjectToWorld(new Thing(this, null, { position: new TwoVector(100, 30)}))\n\n        // create the paddle objects\n        //this.addObjectToWorld(new Paddle(this, null, { position: new TwoVector(PADDING, 0) }));\n    \n    }\n\n    // attach newly connected player to next available paddle\n    serverSidePlayerJoined(ev) {\n        let player = this.addObjectToWorld(new Player(this, null, { position: new TwoVector(100, 100)}))\n        player.playerId = ev.playerId;\n    }\n\n    serverSidePlayerDisconnected(ev) {\n        let player = this.world.queryObjects({ instanceType: Player });\n        for(var i = 0; i < player.length; i++)\n            if(player[i].playerId == ev.playerId) \n                this.removeObjectFromWorld(player[i].id);\n    }\n\n\n    // /////////////////////////////////////////////////////////\n    //\n    // CLIENT ONLY CODE\n    //\n    // /////////////////////////////////////////////////////////\n    clientSideInit() {\n        this.controls = new KeyboardControls(this.renderer.clientEngine);\n        this.controls.bindKey('up', 'up', { repeat: true } );\n        this.controls.bindKey('down', 'down', { repeat: true } );\n        this.controls.bindKey('left', 'left', { repeat: true } );\n        this.controls.bindKey('right', 'right', { repeat: true } );\n    }\n    \n    clientSideDraw() {\n        var gamePanel = document.querySelector('.GamePanel');\n        gamePanel.innerHTML = \"\";\n\n        let things  =    this.world.queryObjects({ instanceType: Thing });\n        let players =   this.world.queryObjects({ instanceType: Player });\n        let client  =    this.world.queryObjects({ playerId: this.playerId })[0];\n        if(!things && !players) return;\n        if(things || players) {\n\n            for(var i = 0; i < players.length; i++) {\n                console.log('this1');\n                if(players[i].playerId == client.playerId) {\n                    var div = document.createElement('div');\n\n                    div.classList.add(`.player${players[i].playerId}`)\n                    div.style.width = '10px';\n                    div.style.height = '10px';\n                    div.style.position = \"absolute\"\n                    div.style.top = BASEY;\n                    div.style.left = BASEX;\n                    div.style.border = \"solid 1px red\";\n\n                    gamePanel.appendChild(div);\n                } else {\n                    console.log('this2');\n                    var div = document.createElement('div');\n\n                    div.classList.add(`.player${players[i].playerId}`)\n                    div.style.width = '10px';\n                    div.style.height = '10px';\n                    div.style.position = \"absolute\"\n                    div.style.top = players[i].position.y + client.position.y + 10 + BASEY;\n                    div.style.left = players[i].position.x + client.position.x + BASEX;\n                    div.style.border = \"solid 1px red\";\n\n                    gamePanel.appendChild(div);\n                }\n            }\n\n            for(var i = 0; i < things.length; i++) {\n                console.log('this3');\n                var div = document.createElement('div');\n\n                div.classList.add(`.things${things[i].playerId}`)\n                div.style.width = '10px';\n                div.style.height = '10px';\n                div.style.position = \"absolute\"\n                div.style.top = things[i].position.y + client.position.y + 10 + BASEY;\n                div.style.left = things[i].position.x + client.position.x + BASEX;\n                div.style.border = \"solid 1px blue\";\n\n                gamePanel.appendChild(div);\n            }\n        }\n    }\n}\n"],"file":"Game.js"}